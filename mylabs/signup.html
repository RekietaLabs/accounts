<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RekietaLabs MyLabs Signup</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      background-color: #0d0d0d;
      color: #1753aa;
      font-family: 'Segoe UI', sans-serif;
      overflow-x: hidden;
    }

    .center {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      text-align: center;
      flex-direction: column;
      padding: 20px;
    }

    .btn {
      background-color: #1753aa;
      color: white;
      border: none;
      padding: 12px 24px;
      font-size: 1rem;
      border-radius: 5px;
      cursor: pointer;
      margin: 10px;
      transition: background-color 0.3s;
    }

    .btn:hover {
      background-color: #14478c;
    }

    .divider {
      color: #1753aa;
      margin: 20px 0;
      font-size: 1rem;
    }

    .hidden {
      display: none;
    }

    .slide {
      position: absolute;
      left: 100vw;
      opacity: 0;
      transition: all 0.8s ease;
      width: 100%;
      max-width: 400px;
      margin: auto;
    }

    .slide.active {
      left: 0;
      opacity: 1;
    }

    input {
      padding: 10px;
      font-size: 1rem;
      border: 1px solid #1753aa;
      border-radius: 5px;
      background: #111;
      color: #1753aa;
      width: 100%;
      margin-top: 15px;
    }

    .error-msg {
      font-size: 0.9rem;
      color: #d32f2f;
      margin-top: 6px;
      text-align: left;
    }

    .tip {
      margin-top: 30px;
      font-size: 1rem;
      color: #ccc;
      animation: fade 1s ease-in-out infinite alternate;
    }

    @keyframes fade {
      0% { opacity: 0.5; }
      100% { opacity: 1; }
    }
  </style>
</head>
<body>

  <!-- Initial choice screen -->
  <div class="center" id="choiceScreen">
    <h1>Welcome to MyLabs by RekietaLabs</h1>
    <button class="btn" id="emailSignupBtn">Sign up with Email</button>
    <div class="divider">— or —</div>
    <p>Use a provider (coming soon)</p>
  </div>

  <!-- Intro slides -->
  <div class="center hidden" id="introScreen">
    <h1 id="introText"></h1>
  </div>

  <!-- Signup question slides -->
  <div class="center hidden" id="questionContainer">
    <div class="slide" id="slide-first_name">
      <h2>What’s your first name?</h2>
      <input type="text" id="first_nameInput" placeholder="First Name" />
    </div>

    <div class="slide" id="slide-last_name">
      <h2>What’s your last name?</h2>
      <input type="text" id="last_nameInput" placeholder="Last Name" />
    </div>

    <div class="slide" id="slide-email">
      <h2>What’s your email?</h2>
      <input type="email" id="emailInput" placeholder="Email Address" />
    </div>

    <div class="slide" id="slide-password">
      <h2>Create a password</h2>
      <input type="password" id="passwordInput" placeholder="Password" />
    </div>

    <button class="btn hidden" id="nextBtn">Next</button>
  </div>

  <!-- Loading screen -->
  <div class="center hidden" id="loadingScreen">
    <img src="loading.gif" alt="Loading" width="60" style="margin-bottom: 20px;">
    <p id="tipText"></p>
  </div>

  <!-- Confirmation screen -->
  <div class="center hidden" id="confirmScreen">
    <img src="yellow-checkmark.gif" alt="Email Sent" width="100" style="margin-bottom: 20px;">
    <h1>Please confirm your email</h1>
    <p id="confirmEmail"></p>
  </div>

  <script>
    let userData = {};
    let currentStep = 0;
    let slides = ['first_name', 'last_name', 'email', 'password'];

    document.getElementById('emailSignupBtn').addEventListener('click', () => {
      document.getElementById('choiceScreen').classList.add('hidden');
      startIntro();
    });

    function startIntro() {
      const introScreen = document.getElementById('introScreen');
      introScreen.classList.remove('hidden');
      const messages = [
        "Are you ready to level up your RekietaLabs Experience with MyLabs?",
        "Well then, let’s get started!"
      ];

      let i = 0;

      function showNextIntro() {
        if (i >= messages.length) {
          introScreen.classList.add('hidden');
          startSignup();
          return;
        }

        document.getElementById('introText').textContent = messages[i];
        i++;
        setTimeout(showNextIntro, 5000); // 5 seconds per intro message
      }

      showNextIntro();
    }

    function startSignup() {
      document.getElementById('questionContainer').classList.remove('hidden');
      showSlide(slides[currentStep]);
    }

    function showSlide(id) {
      document.querySelectorAll('.slide').forEach(slide => {
        slide.classList.remove('active');
      });
      document.getElementById(`slide-${id}`).classList.add('active');
      document.getElementById('nextBtn').classList.remove('hidden');
    }

    document.getElementById('nextBtn').addEventListener('click', () => {
      saveAnswer(slides[currentStep]);
    });

    function saveAnswer(field) {
      const inputId = field + 'Input';
      const value = document.getElementById(inputId)?.value?.trim();
      const input = document.getElementById(inputId);

      let errorBox = input.nextElementSibling;
      if (!errorBox || !errorBox.classList.contains('error-msg')) {
        errorBox = document.createElement('div');
        errorBox.className = 'error-msg';
        input.insertAdjacentElement('afterend', errorBox);
      }

      if (!value) {
        errorBox.innerText = "This field is required.";
        return;
      } else {
        errorBox.innerText = "";
        userData[field] = value;
      }

      currentStep++;
      if (currentStep < slides.length) {
        showSlide(slides[currentStep]);
      } else {
        submitSignup();
      }
    }

    function submitSignup() {
      document.getElementById('questionContainer').classList.add('hidden');
      document.getElementById('loadingScreen').classList.remove('hidden');

      const tips = [
        "Tip: Did you know you can publish your own models on our community Marketplace?",
        "Tip: You can customize your MyLabs Account any way you like!"
      ];

      let tipIndex = 0;
      document.getElementById('tipText').innerText = tips[tipIndex];

      const interval = setInterval(() => {
        tipIndex = (tipIndex + 1) % tips.length;
        document.getElementById('tipText').innerText = tips[tipIndex];
      }, 4000);

      fetch("https://api.rekietalabs.com/signup", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(userData)
      })
      .then(response => response.json())
      .then(result => {
        clearInterval(interval);
        document.getElementById('loadingScreen').classList.add('hidden');
        document.getElementById('confirmScreen').classList.remove('hidden');
        document.getElementById('confirmEmail').innerText = `Please check your email (${userData.email}) to confirm your account.`;
      })
      .catch(error => {
        clearInterval(interval);
        alert("Signup failed: " + error.message);
      });
    }
  </script>
</body>
</html>
