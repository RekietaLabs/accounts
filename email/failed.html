<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Email Confirmation Failed</title>
  <style>
    body {
      margin: 0;
      background-color: #f8faf7;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
        Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      color: #333;
      text-align: center;
      padding: 20px;
    }

    img {
      width: 120px;
      height: 120px;
      margin-bottom: 30px;
    }

    h1 {
      font-size: 2.5rem;
      margin-bottom: 10px;
    }

    p {
      font-size: 1.2rem;
      color: #555;
      max-width: 500px;
    }

    .ref-id {
      margin-top: 20px;
      font-weight: bold;
      color: #999;
    }
  </style>
</head>
<body>
  <img src="email-failure.png" alt="Email Confirmation Failed" />
  <h1>Email Confirmation Failed</h1>
  <p id="message"></p>
  <div class="ref-id" id="refid">REF ID: 765004</div>

  <script>
    const params = new URLSearchParams(window.location.search);
    const reason = params.get("reason") || "default";

    const errorMap = {
      "expired": { message: "Token expired or invalid", ref: "765634" },
      "nomatch": { message: "User ID does not match provided token or user email", ref: "765494" },
      "notfound": { message: "No account found with provided email (e.g. deleted before clicking link)", ref: "765284" },
      "already": { message: "Link used after already confirming (email is already verified)", ref: "765374" },
      "disabled": { message: "Email confirmation disabled for this project (misconfiguration in Supabase)", ref: "765984" },
      "sendfail": { message: "SMTP/Email service failed to send (or misconfigured provider like SendGrid)", ref: "765224" },
      "revoked": { message: "Token manually revoked (admin disabled it before use)", ref: "765814" },
      "tampered": { message: "Token format tampered with (manually edited link/token)", ref: "765194" },
      "supabasefail": { message: "Supabase error while updating user record (e.g., permission issues)", ref: "765314" },
      "default": { message: "Internal server error (fallback generic issue)", ref: "765004" }
    };

    const error = errorMap[reason] || errorMap["default"];
    document.getElementById("message").innerText = error.message;
    document.getElementById("refid").innerText = "REF ID: " + error.ref;
  </script>
</body>
</html>
