<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MyLabs Signup</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body, html {
      margin: 0;
      height: 100%;
      background-color: #0b0b0b;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
        Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
      color: #1753aa;
      overflow: hidden;
    }

    #container {
      position: relative;
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .slide {
      position: absolute;
      width: 80%;
      max-width: 500px;
      text-align: center;
      opacity: 0;
      transform: translateX(100%);
      transition: transform 0.6s ease, opacity 0.6s ease;
    }

    .slide.active {
      opacity: 1;
      transform: translateX(0);
    }

    .slide.exit-left {
      transform: translateX(-100%);
      opacity: 0;
    }

    h1, h2 {
      margin: 10px 0;
      font-weight: normal;
    }

    input {
      padding: 10px;
      margin-top: 15px;
      width: 80%;
      max-width: 300px;
      border: 2px solid #1753aa;
      border-radius: 4px;
      font-size: 16px;
      background: #0b0b0b;
      color: #1753aa;
    }

    button {
      margin-top: 20px;
      padding: 12px 20px;
      background-color: #1753aa;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
      transition: background 0.3s;
    }

    button:hover {
      background-color: #0e3b7a;
    }

    .spinner {
      border: 4px solid rgba(23,83,170,0.3);
      border-top: 4px solid #1753aa;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
      margin: 20px auto;
    }

    @keyframes spin {
      0% { transform: rotate(0deg);}
      100% { transform: rotate(360deg);}
    }

    .tips {
      margin-top: 20px;
      font-size: 14px;
      color: #aaa;
    }
  </style>
</head>
<body>
  <div id="container"></div>

  <script>
    const container = document.getElementById('container');
    const userData = {};

    const slides = [
      {
        id: 'intro1',
        html: `<h1>Are you ready to level up your RekietaLabs Experience with MyLabs?</h1>`,
        autoAdvance: 5000
      },
      {
        id: 'intro2',
        html: `<h2>Well then, let’s get started!</h2>`,
        autoAdvance: 5000
      },
      {
        id: 'firstName',
        html: `
          <h2>What’s your first name?</h2>
          <input type="text" id="firstNameInput" placeholder="First Name" />
          <br>
          <button onclick="saveAnswer('first_name')">Next</button>
        `
      },
      {
        id: 'lastName',
        html: `
          <h2>What’s your last name?</h2>
          <input type="text" id="lastNameInput" placeholder="Last Name" />
          <br>
          <button onclick="saveAnswer('last_name')">Next</button>
        `
      },
      {
        id: 'email',
        html: `
          <h2>What’s your email address?</h2>
          <input type="email" id="emailInput" placeholder="you@email.com" />
          <br>
          <button onclick="saveAnswer('email')">Next</button>
        `
      },
      {
        id: 'password',
        html: `
          <h2>Choose a password:</h2>
          <input type="password" id="passwordInput" placeholder="Password" />
          <br>
          <button onclick="submitSignup()">Sign Up</button>
        `
      },
      {
        id: 'loading',
        html: `
          <h2>Setting up your account...</h2>
          <div class="spinner"></div>
          <div class="tips" id="tip"></div>
        `
      },
      {
        id: 'confirmEmail',
        html: `
          <h2>Almost there!</h2>
          <p>Please check your email:</p>
          <p id="confirmEmailAddress" style="font-weight:bold;"></p>
          <img src="https://your-yellow-checkmark-gif-url-here.gif" alt="Yellow Checkmark" style="width:100px; margin-top:20px;">
        `
      },
      {
        id: 'success',
        html: `
          <h2>That's it!</h2>
          <p>You have successfully activated your account.</p>
          <p>You will be redirected in <span id="countdown">5</span> seconds to our login page.</p>
        `
      }
    ];

    let currentSlide = -1;

    function showNextSlide() {
      if (currentSlide >= 0) {
        const oldSlide = document.getElementById(slides[currentSlide].id);
        if (oldSlide) {
          oldSlide.classList.remove('active');
          oldSlide.classList.add('exit-left');
          setTimeout(() => oldSlide.remove(), 600);
        }
      }

      currentSlide++;
      if (currentSlide < slides.length) {
        const newSlide = document.createElement('div');
        newSlide.id = slides[currentSlide].id;
        newSlide.classList.add('slide', 'active');
        newSlide.innerHTML = slides[currentSlide].html;
        container.appendChild(newSlide);

        if (slides[currentSlide].autoAdvance) {
          setTimeout(() => showNextSlide(), slides[currentSlide].autoAdvance);
        }

        if (slides[currentSlide].id === 'loading') {
          startLoading();
        }
      }
    }

    function saveAnswer(field) {
      const inputId = field + 'Input';
      const value = document.getElementById(inputId)?.value?.trim();
      if (!value) return alert("Please enter a value.");
      userData[field] = value;
      showNextSlide();
    }

    function submitSignup() {
      userData.password = document.getElementById('passwordInput').value;

      showNextSlide();

      fetch('https://api.rekietalabs.com/signup', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(userData)
      })
      .then(res => res.json())
      .then(data => {
        if (data.user_id) {
          document.getElementById('confirmEmailAddress').innerText = userData.email;
          showNextSlide();
        } else {
          alert("Signup failed: " + data.error);
          window.location.reload();
        }
      })
      .catch(err => {
        alert("Network error: " + err.message);
        window.location.reload();
      });
    }

    function startLoading() {
      const tips = [
        "Tip: Did you know you can publish your own models on our community Marketplace?",
        "Tip: Did you know you can customize your MyLabs Account any way you like?",
        "Tip: Keep your password safe and secure!",
        "Tip: More features coming to MyLabs soon!"
      ];
      const tipElement = document.getElementById('tip');
      let index = 0;
      tipElement.innerText = tips[index];

      const interval = setInterval(() => {
        index = (index + 1) % tips.length;
        tipElement.innerText = tips[index];
      }, 3000);

      setTimeout(() => {
        clearInterval(interval);
        showNextSlide();
      }, 5000);
    }

    function startRedirectCountdown() {
      let seconds = 5;
      const span = document.getElementById('countdown');
      const interval = setInterval(() => {
        seconds--;
        span.innerText = seconds;
        if (seconds <= 0) {
          clearInterval(interval);
          window.location.href = "https://accounts.rekietalabs.com/mylabs/login";
        }
      }, 1000);
    }

    document.addEventListener('DOMContentLoaded', () => {
      showNextSlide();
    });
  </script>
</body>
</html>
